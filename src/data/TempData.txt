Yes âœ… thatâ€™s actually the best way to make your UI dynamic!
Hereâ€™s how it works step by step:

ðŸ”¹ Step 1: Backend (.NET API) â€“ Get all reports in a workspace

In your PowerBIController add a new endpoint:

[HttpGet("GetReports")]
public async Task<IActionResult> GetReports()
{
    var app = ConfidentialClientApplicationBuilder
        .Create(clientId)
        .WithClientSecret(clientSecret)
        .WithAuthority($"{authorityUrl}{tenantId}")
        .Build();

    var authResult = await app.AcquireTokenForClient(scope).ExecuteAsync();

    using var pbiClient = new PowerBIClient(
        new Uri("https://api.powerbi.com/"),
        new TokenCredentials(authResult.AccessToken, "Bearer")
    );

    // ðŸ”¹ Fetch all reports in the workspace
    var reports = await pbiClient.Reports.GetReportsInGroupAsync(workspaceId);

    // Return only what UI needs (name + id)
    var result = reports.Value.Select(r => new
    {
        id = r.Id,
        name = r.Name
    });

    return Ok(result);
}


This will return JSON like:

[
  { "id": "1234-aaaa", "name": "Sales Dashboard" },
  { "id": "5678-bbbb", "name": "Finance Report" },
  { "id": "9012-cccc", "name": "Marketing KPIs" }
]

ðŸ”¹ Step 2: Backend â€“ Get embed info for a selected report

Modify your existing GetEmbedInfo to accept a reportId:

[HttpGet("GetEmbedInfo")]
public async Task<IActionResult> GetEmbedInfo(Guid reportId)
{
    var app = ConfidentialClientApplicationBuilder
        .Create(clientId)
        .WithClientSecret(clientSecret)
        .WithAuthority($"{authorityUrl}{tenantId}")
        .Build();

    var authResult = await app.AcquireTokenForClient(scope).ExecuteAsync();

    using var pbiClient = new PowerBIClient(
        new Uri("https://api.powerbi.com/"),
        new TokenCredentials(authResult.AccessToken, "Bearer")
    );

    var report = await pbiClient.Reports.GetReportInGroupAsync(workspaceId, reportId.ToString());

    var generateTokenRequestParameters = new GenerateTokenRequest("view");

    var tokenResponse = await pbiClient.Reports.GenerateTokenAsync(
        workspaceId,
        reportId.ToString(),
        generateTokenRequestParameters
    );

    return Ok(new
    {
        embedToken = tokenResponse.Token,
        embedUrl = report.EmbedUrl,
        reportId = report.Id
    });
}

ðŸ”¹ Step 3: React â€“ Show dropdown & embed selected report
import React, { useEffect, useRef, useState } from "react";
import { models, service } from "powerbi-client";

const PowerBIEmbed: React.FC = () => {
  const reportRef = useRef<HTMLDivElement>(null);
  const [reports, setReports] = useState<{ id: string; name: string }[]>([]);
  const [selectedReport, setSelectedReport] = useState<string>("");

  useEffect(() => {
    // Load all reports on page load
    async function fetchReports() {
      const res = await fetch("https://localhost:5001/api/PowerBI/GetReports");
      const data = await res.json();
      setReports(data);
    }
    fetchReports();
  }, []);

  const loadReport = async (reportId: string) => {
    const response = await fetch(
      `https://localhost:5001/api/PowerBI/GetEmbedInfo?reportId=${reportId}`
    );
    const data = await response.json();

    if (reportRef.current) {
      (window.powerbi as service.Service).reset(reportRef.current);

      const config: models.IReportEmbedConfiguration = {
        type: "report",
        id: data.reportId,
        embedUrl: data.embedUrl,
        accessToken: data.embedToken,
        tokenType: models.TokenType.Embed
      };

      (window.powerbi as service.Service).embed(reportRef.current, config);
    }
  };

  return (
    <div>
      {/* Dropdown for reports */}
      <select
        value={selectedReport}
        onChange={(e) => {
          setSelectedReport(e.target.value);
          loadReport(e.target.value);
        }}
      >
        <option value="">-- Select Report --</option>
        {reports.map((r) => (
          <option key={r.id} value={r.id}>
            {r.name}
          </option>
        ))}
      </select>

      {/* Container for embedded report */}
      <div ref={reportRef} style={{ height: "800px", width: "100%", marginTop: "20px" }} />
    </div>
  );
};

export default PowerBIEmbed;

ðŸ”¹ Workflow

React calls GetReports â†’ dropdown filled with all reports from the workspace.

User selects a report.

React calls GetEmbedInfo?reportId=xxx.

API generates token + embedUrl for that report.

React embeds it in the UI.

ðŸ‘‰ This way you donâ€™t need to hardcode report IDs â€” your React UI becomes fully dynamic and can show any report in the workspace.

Do you want me to also show you how to filter reports by user role (e.g., only show â€œFinanceâ€ reports to Finance users)?



.powerbi-embed-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
  width: 100%;
  height: 100%;
  padding: 20px;
  box-sizing: border-box;

  select {
    width: 280px;
    padding: 8px 12px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 6px;
    background-color: #fff;
    transition: border-color 0.2s;

    &:hover {
      border-color: #888;
    }

    &:focus {
      border-color: #0078d4; // Power BI blue
      outline: none;
    }
  }

  .report-frame {
    flex: 1;
    min-height: 600px;
    width: 100%;
    border: 1px solid #ddd;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    background: #f9f9f9;

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .mock-viewer {
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 500;
      color: #555;
      background: repeating-linear-gradient(
        45deg,
        #f5f5f5,
        #f5f5f5 10px,
        #ececec 10px,
        #ececec 20px
      );
    }
  }
}


-------------------
import "./PowerBIEmbed.scss";

const PowerBIEmbed: React.FC = () => {
  // ...existing logic

  return (
    <div className="powerbi-embed-container">
      <select
        value={selectedReport}
        onChange={(e) => {
          setSelectedReport(e.target.value);
          loadReport(e.target.value);
        }}
      >
        <option value="">-- Select Report --</option>
        {reports.map((r) => (
          <option key={r.id} value={r.id}>
            {r.name}
          </option>
        ))}
      </select>

      <div ref={reportRef} className="report-frame">
        {!selectedReport && (
          <div className="mock-viewer">Please select a report</div>
        )}
      </div>
    </div>
  );
};
